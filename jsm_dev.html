<!DOCTYPE HTML>
<html>
<head>
<title>js.metaret: development examples</title>
<meta charset="utf-8">
<style type="text/css">
body { max-width: 600px; margin: auto;  }
p, h1, h2, h3, h4 {
    font-family: Verdana,Arial,'Lucida Grande',Sans-Serif;
    line-height: 150%;
    text-align: justify;
}
h1, h2, h3 { margin-top: 3em; }
.anchor { margin-left: 0.5em; }
@media only screen { .screen-hidden, .print { display: none; } }
.happy { color: darkgreen; }
.sad { color: darkred; }
</style>
<script type="text/javascript" src="need$.js"></script>
</head>
<body>

<a href="https://github.com/glathoud/js.metaret">
  <img style="position: fixed; top: 0; right: 0; border: 0; margin: 0; padding: 0;"
       src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png"
       alt="Fork me on GitHub">
</a>

<pre><code><strong>dev</strong>    <a href="jsm_out_build.html">test build</a>    <a href="jsm_out_mini.html">test mini</a></code></pre>

<h2>js.metaret: development examples</h2>

<p>Individual <code>.js</code> and <code>.jsm</code> are loaded and
executed recursively through <code>need$</code> (<code>.jsm</code> are
first transformed into standard JavaScript, then executed).</p>

<p>
<script type="text/javascript">
  need$( "jsm_dev/expl.js" );
  need$( "jsm_dev/expl.test.js" );

  var result;
  try {
      result = test();
  } catch (e) {
      console.log( "jsm_dev.html: caught error: " + e, e )
      result = e;
  }

  document.write( result === true ? "<span class='happy'>All tests passed.</span>" : ("<div class='sad'><p>Some tests failed:</p>" + "<pre><code>" + result + "</code></pre></div>") );
</script>
</p>


<h2>Next step: production</h2>

<p>When you are done with development, <code>jsm_build.py</code> can produce a single standalone <code>.js</code> file where all dependencies have been eliminated (*).</p>

<p>Usage (Python 3.2 or later):</p>
<pre><code>./jsm_build.py expl.js
./jsm_build.py jsm_dev/expl.js</code> (equivalent)</pre>

<p>This creates 2 output files:</p>
<pre><code>jsm_out_build/expl.js</code> (readable) <a href="jsm_out_build.html">test build</a>
<code>jsm_out_mini/expl.js</code> (minified) <a href="jsm_out_mini.html">test mini</a>
</pre>

<p>(*)
<br>- <code>need$()</code> replaced by the contents of the corresponding file.
<br>- <code>metafun</code> &amp; <code>metaret</code> replaced by standard JavaScript.
</p>

</body>
</html>
